<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Engineering Workstation</title>
    
    <!-- Existing styles -->
    <link rel="stylesheet" href="src/styles/base.css">
    <link rel="stylesheet" href="src/styles/config.js">
    
    <!-- New workstation styles -->
    <link rel="stylesheet" href="src/web/styles.css">
    
    <style>
        /* Integration styles */
        .tab-container {
            margin-bottom: 2rem;
        }
        
        .tab-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .tab-button {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .tab-button.active {
            border-bottom-color: #3498db;
            color: #3498db;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .legacy-tasker-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <!-- Main Prompt Engineering Workstation Container -->
    <div id="workstation-container"></div>

    <!-- Legacy Tasker Integration (Hidden by default) -->
    <div id="legacy-tab-content" style="display: none;">
        <div class="legacy-tasker-container">
            <h2>üóÇÔ∏è Task Management Integration</h2>
            <p>This section integrates the existing task management system with the prompt engineering workflows.</p>
            
            <!-- Original tasker content -->
            <div class="container">
                <header class="header">
                    <div class="header-content">
                        <h1 class="app-title">Tasker</h1>
                        <div class="theme-selector-container">
                            <label for="theme-selector">Theme:</label>
                            <select id="theme-selector">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                                <option value="ocean">Ocean</option>
                            </select>
                        </div>
                    </div>
                </header>

                <main class="main-content">
                    <div class="stats-section">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Total Tasks</h3>
                                <span id="total-tasks">0</span>
                            </div>
                            <div class="stat-card">
                                <h3>Active Tasks</h3>
                                <span id="active-tasks">0</span>
                            </div>
                            <div class="stat-card">
                                <h3>Completed</h3>
                                <span id="completed-tasks">0</span>
                            </div>
                            <div class="stat-card">
                                <h3>Completion Rate</h3>
                                <span id="completion-rate">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid">
                        <section class="task-form-section">
                            <div class="section-header">
                                <h2>Add New Task</h2>
                            </div>
                            <form id="task-form" class="task-form">
                                <div class="form-group">
                                    <input type="text" id="task-input" placeholder="Enter a new task..." required>
                                </div>
                                <div class="form-group">
                                    <select id="priority-select">
                                        <option value="low">Low Priority</option>
                                        <option value="medium">Medium Priority</option>
                                        <option value="high">High Priority</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary">Add Task</button>
                            </form>
                        </section>

                        <section class="task-list-section">
                            <div class="section-header">
                                <h2>Tasks</h2>
                                <div class="filter-buttons">
                                    <button class="filter-btn active" data-filter="all">All</button>
                                    <button class="filter-btn" data-filter="active">Active</button>
                                    <button class="filter-btn" data-filter="completed">Completed</button>
                                    <button class="filter-btn" data-filter="high">High Priority</button>
                                    <button class="filter-btn" data-filter="medium">Medium Priority</button>
                                    <button class="filter-btn" data-filter="low">Low Priority</button>
                                </div>
                            </div>
                            <div id="task-list" class="task-list">
                                <!-- Tasks will be populated here -->
                            </div>
                        </section>
                    </div>

                    <div class="export-section">
                        <button onclick="tasker.exportTasks()" class="btn btn-secondary">Export Tasks</button>
                        <input type="file" id="import-file" accept=".json" style="display: none;" onchange="handleImport(event)">
                        <button onclick="document.getElementById('import-file').click()" class="btn btn-secondary">Import Tasks</button>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Load existing components -->
    <script src="src/styles/StyleCoordinator.js"></script>
    <script src="src/tasker.js"></script>
    
    <!-- Load new workstation components -->
    <script src="src/PromptTemplateManager.js"></script>
    <script src="src/AIModelManager.js"></script>
    <script src="src/StyleGuideGenerator.js"></script>
    <script src="src/MediaWorkflowManager.js"></script>
    <script src="src/SpecGenerator.js"></script>
    <script src="src/ProjectManager.js"></script>
    <script src="src/PromptWorkstation.js"></script>
    <script src="src/web/PromptWorkstationUI.js"></script>

    <script>
        // Integration script
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing Prompt Engineering Workstation...');
            
            // Add tab functionality for integrating legacy system
            const workstationContainer = document.getElementById('workstation-container');
            const legacyContent = document.getElementById('legacy-tab-content');
            
            // Create tab system
            function createTabSystem() {
                const tabContainer = document.createElement('div');
                tabContainer.className = 'tab-container';
                tabContainer.innerHTML = `
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="workstation">
                            ü§ñ Prompt Workstation
                        </button>
                        <button class="tab-button" data-tab="legacy">
                            üóÇÔ∏è Task Management
                        </button>
                    </div>
                `;
                
                document.body.insertBefore(tabContainer, workstationContainer);
                
                // Add event listeners
                const tabButtons = tabContainer.querySelectorAll('.tab-button');
                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const tab = button.dataset.tab;
                        
                        // Update active button
                        tabButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        
                        // Show/hide content
                        if (tab === 'workstation') {
                            workstationContainer.style.display = 'block';
                            legacyContent.style.display = 'none';
                        } else {
                            workstationContainer.style.display = 'none';
                            legacyContent.style.display = 'block';
                        }
                    });
                });
            }
            
            // Initialize tab system
            createTabSystem();
            
            // File import handler for legacy system
            window.handleImport = function(event) {
                const file = event.target.files[0];
                if (file && window.tasker) {
                    window.tasker.importTasks(file);
                }
            };
            
            console.log('‚úÖ Integration complete!');
        });

        // Error handling
        window.addEventListener('error', function(event) {
            console.error('Application error:', event.error);
        });

        // Service worker registration for PWA capabilities
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed');
                    });
            });
        }
    </script>
</body>
</html>